# Extraction Prompts Configuration
# Edit this file to customize extraction behavior without code changes

# System prompts for different modes
system_prompts:
  expert: "You are an expert document analyzer specialized in {document_type} extraction."
  structured: "You are a structured data extraction system. Extract information with perfect formatting."
  precise: "Extract only clearly visible information. Use NOT_FOUND for any unclear fields."
  flexible: "Extract information, making reasonable inferences for partially visible fields."
  strict: "Extract ONLY information that is completely clear and unambiguous."

# Default system prompt mode
default_system_mode: "expert"

# Conversation protocol (applies to all extractions)
conversation_protocol: |
  CONVERSATION PROTOCOL:
  - Start your response immediately with "DOCUMENT_TYPE:"
  - Do NOT include conversational text like "I'll extract..." or "Based on the document..."
  - Do NOT use bullet points, numbered lists, asterisks, or markdown formatting
  - Output ONLY the structured extraction data
  - End immediately after the last field with no additional text

# Common extraction rules
extraction_rules: |
  RULES:
  - Use exact text from document
  - CRITICAL: Use ONLY pipe separators (|) for lists - NEVER use commas
  - Be conservative: use NOT_FOUND if field is truly missing
  - For monetary values: Include currency symbol (e.g., $123.45)
  - For dates: Match format shown in document
  - For lists: Separate items with " | " (space-pipe-space)
  - Do NOT invent or hallucinate information

# Document-specific instructions
document_instructions:
  invoice: |
    This is an INVOICE document. Focus on:
    - Vendor/supplier information (name, ABN, address)
    - Customer/payer information
    - Line items with quantities and prices
    - GST and total amounts
    - Invoice date and number

  receipt: |
    This is a RECEIPT document. Focus on:
    - Merchant information
    - Transaction date and time
    - Purchased items with quantities and prices
    - Payment method and totals
    - GST if applicable

  bank_statement: |
    This is a BANK STATEMENT document. Focus on:
    - Statement date range
    - ALL individual transactions (do NOT combine multiple transactions)
    - Transaction descriptions exactly as shown
    - Transaction dates (one per transaction)
    - Amounts paid (debits/withdrawals)
    - CRITICAL: If multiple transactions occur on the same date, extract each as a SEPARATE row
    - CRITICAL: Do NOT summarize or combine transactions

# Document type detection prompt
detection_prompt: |
  Analyze this document image and identify its type.

  Respond with ONLY ONE of these document types:
  - INVOICE
  - RECEIPT
  - BANK_STATEMENT

  Start your response immediately with "DOCUMENT_TYPE: [type]"
  Do not include any explanation or additional text.

# Extraction prompt template (fields will be injected dynamically)
extraction_template: |
  Extract structured data from this business document image.

  {conversation_protocol}

  {document_instructions}

  OUTPUT FORMAT ({field_count} FIELDS):

  {field_format}

  {extraction_rules}

# Table extraction prompt (for markdown OCR)
table_extraction_template: |
  Extract the transaction table from this bank statement image as markdown.

  STEP-BY-STEP PROCESS:
  1. First, locate the column headers and note their POSITIONS (left to right)
  2. For each row, read values according to those fixed column POSITIONS
  3. If a position has no value (empty cell), write "NOT_FOUND" for that position
  4. DO NOT skip empty positions - every row must have the same number of columns

  Look at the bank statement and find the main transaction table.
  Extract ALL rows from the table exactly as shown, including:
  - All column headers
  - All transaction rows (do not skip any rows)
  - Preserve exact spacing and alignment

  CRITICAL COLUMN RULES:

  ‚ö†Ô∏è RULE 1: Read columns by POSITION, not by content!
  - First, identify the VERTICAL POSITION of each column by looking at the headers
  - The Withdrawal column is always in the SAME POSITION for every row
  - The Deposit column is always in the SAME POSITION for every row
  - The Balance column is always in the SAME POSITION for every row
  - DO NOT shift columns when you encounter empty cells!
  - Empty cells still OCCUPY SPACE - write "NOT_FOUND" for them, don't skip them!

  ‚ö†Ô∏è RULE 2: NEVER skip over empty cells - they still count as columns!
  - If Withdrawal is empty ‚Üí write "NOT_FOUND" in that column position
  - If Deposit is empty ‚Üí write "NOT_FOUND" in that column position
  - DO NOT read the next value and put it in the empty cell's position
  - Each row must have the SAME NUMBER of columns

  ‚ö†Ô∏è RULE 3: Read each column independently - DO NOT COPY values between columns!
  - Withdrawal column: Contains withdrawal/debit amounts (money OUT)
  - Deposit column: Contains deposit/credit amounts (money IN)
  - Balance column: Contains running balance after transaction
  - These are THREE DIFFERENT VALUES - never duplicate between columns!

  ‚ö†Ô∏è RULE 4: NEVER duplicate Balance into Withdrawal or Deposit columns!
  - ‚ùå WRONG: | Date | Desc | $500 | $1000 | $1000 | ‚Üê Deposit copied from Balance!
  - ‚úÖ CORRECT: | Date | Desc | NOT_FOUND | $500 | $1000 |
  - ‚ùå WRONG: | Date | Desc | $1000 | $1000 | $500 | ‚Üê Withdrawal copied from Balance!
  - ‚úÖ CORRECT: | Date | Desc | $500 | NOT_FOUND | $1000 |

  ‚ö†Ô∏è RULE 5: Each transaction is EITHER withdrawal OR deposit (not both)
  - Look at the image carefully - find which column has the amount
  - If Withdrawal column (in image) has an amount ‚Üí extract it, put the text "NOT_FOUND" in Deposit
  - If Deposit column (in image) has an amount ‚Üí extract it, put the text "NOT_FOUND" in Withdrawal
  - If column is blank/empty in image ‚Üí write the text "NOT_FOUND" (don't copy from Balance!)
  - "NOT_FOUND" is a literal text string - write these exact 9 characters, NOT an empty/blank cell!

  ‚ö†Ô∏è RULE 6: If you can't read a value clearly, write the text "NOT_FOUND"
  - DO NOT guess or copy from other columns
  - DO NOT use the Balance value for Withdrawal or Deposit
  - DO NOT leave cells empty/blank - always write "NOT_FOUND" for missing values
  - Better to say "NOT_FOUND" than to copy the wrong value

  ‚ö†Ô∏è RULE 7: Verify column alignment for EVERY row
  - Count the column positions: 1=Date, 2=Description, 3=Withdrawal, 4=Deposit, 5=Balance
  - Make sure each row has exactly 5 values (use "NOT_FOUND" to fill empty positions)
  - The rightmost value should ALWAYS be Balance
  - If you see the same value in both Deposit and Balance columns ‚Üí you made a mistake!

  CRITICAL ROW RULES FOR DATE-GROUPED STATEMENTS:
  - DETECTION: If a date header has multiple balance amounts shown on the far right, multiple transactions exist for that date
  - Create a SEPARATE row for EACH transaction under that date header
  - Repeat the same date in the Date column for each transaction
  - Each transaction gets its own row with: unique description, unique amount, unique balance
  - Do NOT combine multiple transactions into a single row
  - Count the number of balances shown = number of rows to create for that date

  Output ONLY the markdown table, nothing else.
  Use this markdown table format:

  | Date | Description | Withdrawal | Deposit | Balance |
  |------|-------------|------------|---------|---------|
  | ...  | ...         | ...        | ...     | ...     |

  IMPORTANT: For missing/empty values, use the literal text "NOT_FOUND" (9 characters):

  ‚úÖ CORRECT - Each row has 5 columns (empty cells filled with "NOT_FOUND"):
  | DD/MM/YYYY | Withdrawal Transaction | $XXX.XX | NOT_FOUND | $YYYY.YY |  ‚Üê Withdrawal only
  | DD/MM/YYYY | Deposit Transaction | NOT_FOUND | $AAA.AA | $BBBB.BB |  ‚Üê Deposit only

  ‚ùå WRONG - Column shift (Balance copied to Deposit position):
  | DD/MM/YYYY | Purchase Description | $100.00 | $5000.00 | $5500.00 |
  Problem: $5000.00 appears in BOTH Deposit and Balance columns - this is impossible!
  The $5000.00 is actually the Balance, not a Deposit amount.

  ‚úÖ CORRECT version of above row:
  | DD/MM/YYYY | Purchase Description | $100.00 | NOT_FOUND | $5000.00 |  ‚Üê Deposit empty = "NOT_FOUND"

  ‚ùå WRONG - DO NOT use empty cells:
  | DD/MM/YYYY | Income Description |  | $AAA.AA | $BBBB.BB |  ‚Üê NO! Write "NOT_FOUND" instead of blank!

  Extract ALL rows - do not filter or skip any transactions.

# ============================================================================
# MULTI-TURN EXTRACTION PROMPTS
# ============================================================================

# Structure detection - Extract FULL markdown table + metadata
structure_detection_template: |
  Extract the transaction table from this bank statement image as markdown.

  STEP-BY-STEP PROCESS:
  1. First, locate the column headers and note their POSITIONS (left to right)
  2. For each row, read values according to those fixed column POSITIONS
  3. If a position has no value (empty cell), write "NOT_FOUND" for that position
  4. DO NOT skip empty positions - every row must have the same number of columns

  Look at the bank statement and find the main transaction table.
  Extract ALL rows from the table exactly as shown, including:
  - All column headers
  - All transaction rows (do not skip any rows)
  - Preserve exact spacing and alignment

  CRITICAL COLUMN RULES:

  ‚ö†Ô∏è RULE 1: Read columns by POSITION, not by content!
  - First, identify the VERTICAL POSITION of each column by looking at the headers
  - The Withdrawal column is always in the SAME POSITION for every row
  - The Deposit column is always in the SAME POSITION for every row
  - The Balance column is always in the SAME POSITION for every row
  - DO NOT shift columns when you encounter empty cells!
  - Empty cells still OCCUPY SPACE - write "NOT_FOUND" for them, don't skip them!

  ‚ö†Ô∏è RULE 2: NEVER skip over empty cells - they still count as columns!
  - If Withdrawal is empty ‚Üí write "NOT_FOUND" in that column position
  - If Deposit is empty ‚Üí write "NOT_FOUND" in that column position
  - DO NOT read the next value and put it in the empty cell's position
  - Each row must have the SAME NUMBER of columns

  ‚ö†Ô∏è RULE 3: Read each column independently - DO NOT COPY values between columns!
  - Withdrawal column: Contains withdrawal/debit amounts (money OUT)
  - Deposit column: Contains deposit/credit amounts (money IN)
  - Balance column: Contains running balance after transaction
  - These are THREE DIFFERENT VALUES - never duplicate between columns!

  ‚ö†Ô∏è RULE 4: NEVER duplicate Balance into Withdrawal or Deposit columns!
  - ‚ùå WRONG: | Date | Desc | $500 | $1000 | $1000 | ‚Üê Deposit copied from Balance!
  - ‚úÖ CORRECT: | Date | Desc | NOT_FOUND | $500 | $1000 |
  - ‚ùå WRONG: | Date | Desc | $1000 | $1000 | $500 | ‚Üê Withdrawal copied from Balance!
  - ‚úÖ CORRECT: | Date | Desc | $500 | NOT_FOUND | $1000 |

  ‚ö†Ô∏è RULE 5: Each transaction is EITHER withdrawal OR deposit (not both)
  - Look at the image carefully - find which column has the amount
  - If Withdrawal column (in image) has an amount ‚Üí extract it, put the text "NOT_FOUND" in Deposit
  - If Deposit column (in image) has an amount ‚Üí extract it, put the text "NOT_FOUND" in Withdrawal
  - If column is blank/empty in image ‚Üí write the text "NOT_FOUND" (don't copy from Balance!)
  - "NOT_FOUND" is a literal text string - write these exact 9 characters, NOT an empty/blank cell!

  ‚ö†Ô∏è RULE 6: If you can't read a value clearly, write the text "NOT_FOUND"
  - DO NOT guess or copy from other columns
  - DO NOT use the Balance value for Withdrawal or Deposit
  - DO NOT leave cells empty/blank - always write "NOT_FOUND" for missing values
  - Better to say "NOT_FOUND" than to copy the wrong value

  ‚ö†Ô∏è RULE 7: Verify column alignment for EVERY row
  - Count the column positions: 1=Date, 2=Description, 3=Withdrawal, 4=Deposit, 5=Balance
  - Make sure each row has exactly 5 values (use "NOT_FOUND" to fill empty positions)
  - The rightmost value should ALWAYS be Balance
  - If you see the same value in both Deposit and Balance columns ‚Üí you made a mistake!

  CRITICAL ROW RULES FOR DATE-GROUPED STATEMENTS:
  - DETECTION: If a date header has multiple balance amounts shown on the far right, multiple transactions exist for that date
  - Create a SEPARATE row for EACH transaction under that date header
  - Repeat the same date in the Date column for each transaction
  - Each transaction gets its own row with: unique description, unique amount, unique balance
  - Do NOT combine multiple transactions into a single row
  - Count the number of balances shown = number of rows to create for that date

  Task 1: Analyze the table structure - Choose ONE structure type:

  üîµ FLAT Structure:
  - Every transaction row has a populated Date column
  - Date column is NEVER blank or empty
  - Number of dates = number of transactions
  - Each row is a complete independent transaction

  üü† DATE_GROUPED Structure:
  - Date appears once as a header/label for multiple transactions
  - Transactions below the date have BLANK/EMPTY Date cells
  - Number of dates < number of transactions
  - Transactions are grouped/nested under date headers

  CLASSIFICATION METHOD:
  Step 1: Count total transaction rows (count Balance column entries)
  Step 2: Count populated Date cells (non-blank dates)
  Step 3: Compare counts:
    - If populated dates = total transactions ‚Üí FLAT
    - If populated dates < total transactions ‚Üí DATE_GROUPED

  Task 2: Extract metadata and full table

  CRITICAL: To count transaction rows accurately:
  - Count the number of entries in the rightmost column (Balance)
  - This equals the number of transaction rows
  - Do NOT count the header row
  - Example: 40 balance entries = 40 transaction rows

  Output format:
  STRUCTURE_TYPE: [flat | date_grouped]
  COLUMN_HEADERS: [header1] | [header2] | [header3] | ...
  ESTIMATED_ROWS: [count balance column entries - this equals transaction rows]

  MARKDOWN_TABLE:
  | Header1 | Header2 | Header3 | ... |
  |---------|---------|---------|-----|
  | value1  | value2  | value3  | ... |
  | value1  | value2  | value3  | ... |
  ...

  IMPORTANT: For missing/empty values, use the literal text "NOT_FOUND" (9 characters):

  ‚úÖ CORRECT - Each row has 5 columns (empty cells filled with "NOT_FOUND"):
  | DD/MM/YYYY | Withdrawal Transaction | $XXX.XX | NOT_FOUND | $YYYY.YY |  ‚Üê Withdrawal only
  | DD/MM/YYYY | Deposit Transaction | NOT_FOUND | $AAA.AA | $BBBB.BB |  ‚Üê Deposit only

  ‚ùå WRONG - Column shift (Balance copied to Deposit position):
  | DD/MM/YYYY | Purchase Description | $100.00 | $5000.00 | $5500.00 |
  Problem: $5000.00 appears in BOTH Deposit and Balance columns - this is impossible!
  The $5000.00 is actually the Balance, not a Deposit amount.

  ‚úÖ CORRECT version of above row:
  | DD/MM/YYYY | Purchase Description | $100.00 | NOT_FOUND | $5000.00 |  ‚Üê Deposit empty = "NOT_FOUND"

  ‚ùå WRONG - DO NOT use empty cells:
  | DD/MM/YYYY | Income Description |  | $AAA.AA | $BBBB.BB |  ‚Üê NO! Write "NOT_FOUND" instead of blank!

  Extract ALL rows - do not filter or skip any transactions.

# Column extraction - Extract values from a specific column
column_extraction_template: |
  Look at the transaction table in this bank statement.

  Find the column with the header "{column_name}".

  Extract ALL data values from the "{column_name}" column.
  {additional_context}

  CRITICAL RULES:
  - Extract ONLY actual data values from the "{column_name}" column (NOT from any other column)
  - Do NOT extract the column header itself
  - Do NOT extract any instruction text, markdown formatting, or bold text
  - Do NOT include values from other columns
  - Extract ONLY the actual transaction data
  - List one value per line
  - If a cell is empty, write "NOT_FOUND"
  - Extract values in top-to-bottom order

  Output format (ONLY the actual data values, one per line):
  value1
  value2
  value3
  ...

# Date column extraction (specialized)
date_column_extraction_template: |
  Look at the transaction table in this bank statement.

  Find the column with the header "{column_name}".

  Extract ALL date values from the "{column_name}" column.

  CRITICAL RULES:
  - Extract ONLY actual date values (e.g., "DD/MM/YYYY", "M/DD/YYYY")
  - Do NOT extract the column header itself
  - Do NOT extract any instruction text, markdown formatting (like **bold**), or explanatory text
  - If the table uses date grouping (same date for multiple transactions), REPEAT the date for each transaction
  - Count the number of balance amounts shown for a date = number of times to repeat that date
  - Extract dates in the order transactions appear (top to bottom)
  - Preserve the exact date format shown in the document (DD/MM/YYYY)
  - List one date per line

  Output format (ONLY the actual dates, one per line):
  DD/MM/YYYY
  DD/MM/YYYY
  DD/MM/YYYY
  ...

# Turn 1: Filter to 3 columns (TEXT FILTERING ONLY - DO NOT RE-EXTRACT)
turn1_3column_template: |
  ‚ö†Ô∏è CRITICAL: This is a TEXT FILTERING task, NOT a data extraction task!

  I previously extracted a full markdown table from the bank statement image.
  That table is in my previous response.

  YOUR TASK: Copy the table from my previous response and remove 2 columns.

  STEP 1: Find the markdown table in my previous response (starts with "MARKDOWN_TABLE:")

  STEP 2: Create a new table with ONLY these 3 columns:
  - Column 1: "{date_column}"
  - Column 2: "{description_column}"
  - Column 3: "{debit_column}"

  STEP 3: For EACH row in the original table:
  - Copy the value from "{date_column}" column ‚Üí paste into new table column 1
  - Copy the value from "{description_column}" column ‚Üí paste into new table column 2
  - Copy the value from "{debit_column}" column ‚Üí paste into new table column 3
  - Keep the EXACT text character-by-character - do NOT modify anything!

  ‚ùå FORBIDDEN ACTIONS (DO NOT DO THESE):
  - Do NOT look at the bank statement image again
  - Do NOT re-extract data from the image
  - Do NOT "correct" or "fix" any values
  - Do NOT add missing digits (e.g., if it says $123.45, do NOT change to $1123.45)
  - Do NOT remove extra digits (keep values exactly as shown)
  - Do NOT change "NOT_FOUND" to a dollar amount
  - Do NOT change dollar amounts to "NOT_FOUND"
  - Do NOT modify descriptions (keep typos, truncations, everything)
  - Do NOT modify dates
  - Do NOT skip or add rows

  ‚úÖ CORRECT BEHAVIOR - COPY EXACTLY:
  If original table row says: | DD/MM/YYYY | Withdrawal Description... | $XXX.XX | NOT_FOUND | $YYYY.YY |
  Your output should be: | DD/MM/YYYY | Withdrawal Description... | $XXX.XX |

  If original table row says: | DD/MM/YYYY | Deposit Description... | NOT_FOUND | $AAA.AA | $BBBB.BB |
  Your output should be: | DD/MM/YYYY | Deposit Description... | NOT_FOUND |

  REMEMBER: You are FILTERING columns (removing unwanted columns), NOT extracting data!
  Source: My previous response (the text I already gave you)
  Method: Copy the specified columns character-by-character

  Output the 3-column markdown table:
  | {date_column} | {description_column} | {debit_column} |
  |---------------|----------------------|----------------|
  | ...exact values from columns 1, 2, and 3 of original table... |

# Turn 2: Remove rows with "NOT_FOUND" in debit column (withdrawals only)
turn2_filter_debits_template: |
  I previously created a 3-column markdown table with columns: {date_column}, {description_column}, {debit_column}.

  Now, remove rows where the "{debit_column}" column is missing or empty.
  Keep ONLY rows where the "{debit_column}" column has a dollar amount.

  CRITICAL RULES:
  - Remove ANY row where "{debit_column}" = "NOT_FOUND" (these are deposits/credits)
  - Remove ANY row where "{debit_column}" is blank/empty (these are also deposits/credits)
  - Keep ONLY rows where "{debit_column}" has a dollar amount like $123.45 (these are withdrawals/debits)
  - "NOT_FOUND" is a literal text string - if you see this, remove that row
  - Empty cells (|  |) also mean no withdrawal - remove those rows too
  - Do NOT modify any column values or headers for the rows you keep
  - Do NOT change dollar amounts or descriptions
  - Maintain the same row order for kept rows
  - Output ONLY the filtered rows with actual dollar amounts

  Examples of rows to REMOVE (deposits/credits):
  | DD/MM/YYYY | Income Payment Description | NOT_FOUND |  ‚Üê Remove (has "NOT_FOUND")
  | DD/MM/YYYY | Deposit Description |  |  ‚Üê Remove (empty cell)

  Examples of rows to KEEP (withdrawals/debits):
  | DD/MM/YYYY | Withdrawal Description | $XXX.XX |  ‚Üê Keep (has dollar amount)
  | DD/MM/YYYY | Payment Description | $YYY.YY |  ‚Üê Keep (has dollar amount)

  Output the filtered markdown table (withdrawals only - rows with dollar amounts):
  | {date_column} | {description_column} | {debit_column} |
  |---------------|----------------------|----------------|
  | ...only rows where {debit_column} has dollar amounts (NOT "NOT_FOUND" or empty)... |

# Field format guidelines
field_format_guidelines:
  text: "Plain text exactly as shown"
  monetary: "Currency symbol + amount (e.g., $123.45)"
  date: "DD/MM/YYYY or DD-MMM-YY format"
  list: "Item 1 | Item 2 | Item 3 (pipe-separated)"
  boolean: "true or false (lowercase)"
  abn: "XX XXX XXX XXX (with spaces)"

# ============================================================================
# MODEL-SPECIFIC ADAPTATIONS (Phase 1)
# ============================================================================

# Model characteristics and optimization settings
model_adaptations:
  llama-3.2-vision:
    style: "step-by-step"
    instruction_format: "numbered_steps"
    verbosity: "detailed"
    reasoning_capability: "high"
    preferred_approach: "explicit_guidance"

  llama-3.2-11b-vision:
    style: "step-by-step"
    instruction_format: "numbered_steps"
    verbosity: "detailed"
    reasoning_capability: "high"
    preferred_approach: "explicit_guidance"

  llama-3.2-11b-vision-8bit:
    style: "step-by-step"
    instruction_format: "numbered_steps"
    verbosity: "detailed"
    reasoning_capability: "high"
    preferred_approach: "explicit_guidance"

  internvl3:
    style: "direct"
    instruction_format: "concise_list"
    verbosity: "minimal"
    reasoning_capability: "medium"
    preferred_approach: "direct_extraction"

  internvl3-2b:
    style: "direct"
    instruction_format: "concise_list"
    verbosity: "minimal"
    reasoning_capability: "medium"
    preferred_approach: "direct_extraction"

  internvl3-8b:
    style: "direct"
    instruction_format: "structured_list"
    verbosity: "moderate"
    reasoning_capability: "high"
    preferred_approach: "guided_extraction"

  internvl3-8b-quantized:
    style: "direct"
    instruction_format: "structured_list"
    verbosity: "moderate"
    reasoning_capability: "high"
    preferred_approach: "guided_extraction"

# Model-specific document extraction instructions
model_specific_document_instructions:
  # Llama models - verbose step-by-step approach with variants
  llama-3.2-vision:
    # Default variant - complex, detailed, step-by-step
    default:
      invoice: |
        ## STEP-BY-STEP EXTRACTION:

        ### STEP 1: Document Identification
        Look at the header - is it an INVOICE, BILL, QUOTE, or ESTIMATE?
        DOCUMENT_TYPE: [INVOICE or NOT_FOUND]

        ### STEP 2: Business Information (Usually at the top)
        Find the supplier/business details in the document header:
        BUSINESS_ABN: [Find ABN number - must be exactly 11 digits (e.g., 12 345 678 901) or NOT_FOUND]
        SUPPLIER_NAME: [Company name providing goods/services from document header or NOT_FOUND]
        BUSINESS_ADDRESS: [Complete business address (can be multi-line) or NOT_FOUND]

        ### STEP 3: Customer Information (Look for "Bill To" or "Customer" section)
        Find the customer/client details:
        PAYER_NAME: [Customer/client name or NOT_FOUND]
        PAYER_ADDRESS: [Customer/client address or NOT_FOUND]

        ### STEP 4: Date Information
        INVOICE_DATE: [Date of invoice/bill in DD/MM/YYYY format or NOT_FOUND]

        ### STEP 5: Line Items (From the itemized table/list)
        Count the number of line items and extract each one systematically:
        LINE_ITEM_DESCRIPTIONS: [Item 1 description | Item 2 description | etc. or NOT_FOUND]
        LINE_ITEM_QUANTITIES: [Qty 1 | Qty 2 | etc. (match description order) or NOT_FOUND]
        LINE_ITEM_PRICES: [$Unit price 1 | $Unit price 2 | etc. or NOT_FOUND]
        LINE_ITEM_TOTAL_PRICES: [$Total 1 | $Total 2 | etc. or NOT_FOUND]

        ### STEP 6: Tax and Totals (Usually at the bottom)
        Find the financial summary section:
        IS_GST_INCLUDED: [Look for GST/tax line - answer "true" if present, "false" if not shown]
        GST_AMOUNT: [Extract GST/tax amount with $ symbol or NOT_FOUND]
        TOTAL_AMOUNT: [Extract final total/amount due with $ symbol or NOT_FOUND]

      receipt: |
        ## STEP-BY-STEP RECEIPT EXTRACTION:

        ### STEP 1: Document Type
        DOCUMENT_TYPE: [Should be RECEIPT for payment confirmations or NOT_FOUND]

        ### STEP 2: Merchant Information (Top of receipt)
        Find the store/merchant details at the top:
        BUSINESS_ABN: [Look for ABN - exactly 11 digits (often not on receipts) or NOT_FOUND]
        SUPPLIER_NAME: [Store/restaurant/merchant name or NOT_FOUND]
        BUSINESS_ADDRESS: [Store address if shown (may be partial) or NOT_FOUND]

        ### STEP 3: Customer Information (Usually minimal or absent)
        Check if customer details are shown (rare on receipts):
        PAYER_NAME: [Customer name if shown or NOT_FOUND]
        PAYER_ADDRESS: [Customer address if shown or NOT_FOUND]

        ### STEP 4: Transaction Date
        INVOICE_DATE: [Date of purchase/transaction in DD/MM/YYYY format or NOT_FOUND]

        ### STEP 5: Items Purchased
        Look at the itemized list and extract systematically:
        LINE_ITEM_DESCRIPTIONS: [Item 1 | Item 2 | etc. or NOT_FOUND]
        LINE_ITEM_QUANTITIES: [Qty 1 | Qty 2 | etc. (use "1" if not shown) or NOT_FOUND]
        LINE_ITEM_PRICES: [$Price 1 | $Price 2 | etc. or NOT_FOUND]
        LINE_ITEM_TOTAL_PRICES: [$Total 1 | $Total 2 | etc. or NOT_FOUND]

        ### STEP 6: Payment Summary
        Find the payment totals (usually at bottom):
        IS_GST_INCLUDED: [Look for GST/tax line - "true" if shown, "false" if not]
        GST_AMOUNT: [GST/tax amount with $ symbol if shown or NOT_FOUND]
        TOTAL_AMOUNT: [Final total/amount paid with $ symbol or NOT_FOUND]

      bank_statement: |
        ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è CRITICAL RULES - READ THESE FIRST ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è
        ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

        RULE 1: ONLY EXTRACT ROWS WHERE WITHDRAWAL COLUMN HAS A DOLLAR AMOUNT

        For 5-column statements: Date | Description | Withdrawal | Deposit | Balance

        ‚úÖ Withdrawal column has amount ‚Üí EXTRACT this row (date, description, amount)
        ‚ùå Withdrawal column is EMPTY/BLANK ‚Üí SKIP this row COMPLETELY

        Visual guide (look at the Withdrawal column):

        Date | Description    | Withdrawal | Deposit | Balance
        ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        XX   | PURCHASE       | $50.00     |         | $XXX   ‚Üê HAS AMOUNT = EXTRACT
        XX   | SALARY         |            | $2000   | $XXX   ‚Üê BLANK = SKIP ENTIRELY
        XX   | PURCHASE       | $30.00     |         | $XXX   ‚Üê HAS AMOUNT = EXTRACT
        XX   | INTEREST       |            | $10     | $XXX   ‚Üê BLANK = SKIP ENTIRELY

        ‚ö†Ô∏è CRITICAL: If Withdrawal is blank, DO NOT extract date, description, OR amount!

        BLANK Withdrawal = CREDIT/DEPOSIT = Money IN = SKIP THE ENTIRE ROW!

        Common credit transactions to SKIP (Withdrawal always blank):
        - INCOME DEPOSIT (Withdrawal blank)
        - PAYROLL CREDIT (Withdrawal blank)
        - INTEREST CREDIT (Withdrawal blank)
        - REFUND (Withdrawal blank)
        - Any description where Withdrawal column is empty/blank

        RULE 2: NEVER READ AMOUNTS FROM THE DEPOSIT COLUMN

        ‚ùå DO NOT extract amounts from the Deposit column (money IN)
        ‚úÖ ONLY extract amounts from the Withdrawal column (money OUT)

        If Withdrawal is blank but Deposit has $500 ‚Üí DO NOT extract $500!

        RULE 3: EXTRACT EVERY ROW SEPARATELY - DO NOT DE-DUPLICATE

        ‚úÖ Same description on 3 different dates? ‚Üí Extract ALL 3 rows separately
        ‚úÖ Same description with different amounts? ‚Üí Extract ALL occurrences
        ‚ùå DO NOT combine rows with identical descriptions
        ‚ùå DO NOT skip duplicate descriptions

        Each row = separate transaction!

        ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

        ## EXTRACTION PROCESS:

        ### STEP 1 - Find the transaction table
        Look for the main table with columns like:
        - Date | Description | Withdrawal | Deposit | Balance
        - Date | Description | Debit | Credit | Balance

        Note: "Withdrawal" = "Debit" (both mean money OUT)
        Note: "Deposit" = "Credit" (both mean money IN)

        ### STEP 2 - Apply the ONE-COLUMN CHECK to each row

        Go through each row and CHECK ONLY THE WITHDRAWAL COLUMN:

        Decision tree for EACH row:
        1. Look at Withdrawal column
        2. Does it have a $ amount? YES ‚Üí Extract this row | NO ‚Üí Skip this row

        Date | Description     | Withdrawal | Deposit  | Balance
        ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        11/01| SUPERMARKET     | $45.20     | [empty]  | $2,154.80
        ‚úÖ EXTRACT Row 1: Withdrawal HAS amount ($45.20)
           ‚Üí Add: 11/01/2024 | SUPERMARKET | $45.20

        12/01| FUEL STATION    | $67.30     | [empty]  | $2,087.50
        ‚úÖ EXTRACT Row 2: Withdrawal HAS amount ($67.30)
           ‚Üí Add: 12/01/2024 | FUEL STATION | $67.30

        13/01| FUEL STATION    | $72.85     | [empty]  | $2,014.65
        ‚úÖ EXTRACT Row 3: Withdrawal HAS amount ($72.85) - duplicate description OK!
           ‚Üí Add: 13/01/2024 | FUEL STATION | $72.85

        14/01| PAYROLL DEPOSIT | [EMPTY]    | $2,800.00| $4,814.65
        ‚ùå SKIP Row 4: Withdrawal is BLANK (ignore $2,800 in Deposit!)
           ‚Üí Add: NOTHING to any list

        15/01| PHARMACY        | $24.80     | [empty]  | $4,789.85
        ‚úÖ EXTRACT Row 5: Withdrawal HAS amount ($24.80)
           ‚Üí Add: 15/01/2024 | PHARMACY | $24.80

        16/01| SUPERMARKET     | $89.15     | [empty]  | $4,700.70
        ‚úÖ EXTRACT Row 6: Withdrawal HAS amount ($89.15) - duplicate description OK!
           ‚Üí Add: 16/01/2024 | SUPERMARKET | $89.15

        17/01| INTEREST CREDIT | [EMPTY]    | $12.35   | $4,713.05
        ‚ùå SKIP Row 7: Withdrawal is BLANK (ignore $12.35 in Deposit!)
           ‚Üí Add: NOTHING to any list

        18/01| RESTAURANT      | $56.40     | [empty]  | $4,656.65
        ‚úÖ EXTRACT Row 8: Withdrawal HAS amount ($56.40)
           ‚Üí Add: 18/01/2024 | RESTAURANT | $56.40

        Rows to extract: 1, 2, 3, 5, 6, 8 (total: 6 rows)
        Rows to skip: 4, 7 (Withdrawal blank)

        ### STEP 3 - Extract data from ‚úÖ rows ONLY (keep lists synchronized!)

        ‚ö†Ô∏è CRITICAL: Build all 3 lists from the SAME rows! ‚ö†Ô∏è

        Go through ONLY the rows you marked ‚úÖ above (where Withdrawal has amount).
        For EACH ‚úÖ row, extract ALL THREE pieces of data together:

        Row marked ‚úÖ? ‚Üí Extract:
        1. DATE from that row ‚Üí add to TRANSACTION_DATES list
        2. DESCRIPTION from that row ‚Üí add to LINE_ITEM_DESCRIPTIONS list
        3. AMOUNT from Withdrawal column ‚Üí add to TRANSACTION_AMOUNTS_PAID list

        Row marked ‚ùå? ‚Üí Skip completely, do NOT add anything to any list!

        Example - if you marked these rows ‚úÖ:
        - Row 1: Add date AND description AND amount
        - Row 2: Add date AND description AND amount
        - Row 3: Add date AND description AND amount
        - SKIP Row 4 (PAYROLL/SALARY/CREDIT with blank Withdrawal) - add NOTHING!
        - Row 5: Add date AND description AND amount
        - Row 6: Add date AND description AND amount
        - SKIP Row 7 (INTEREST/DEPOSIT with blank Withdrawal) - add NOTHING!
        - Row 8: Add date AND description AND amount

        Result: ALL THREE LISTS have exactly 6 items (same count, same rows)

        Use " | " separator between items in each list.

        ### STEP 4 - MANDATORY VERIFICATION (check before output):

        Count verification:
        ‚ñ° Count rows with Withdrawal amounts in image: ___ rows
        ‚ñ° Count items in TRANSACTION_DATES: ___ items
        ‚ñ° Count items in LINE_ITEM_DESCRIPTIONS: ___ items
        ‚ñ° Count items in TRANSACTION_AMOUNTS_PAID: ___ items
        ‚ñ° Are all 3 counts IDENTICAL? (Must be YES!)

        Content verification:
        ‚ñ° Did I check EVERY row in the table?
        ‚ñ° Did I SKIP all rows where Withdrawal column is blank/empty?
        ‚ñ° Did I include ONLY rows where Withdrawal column has a $ amount?
        ‚ñ° Are ALL amounts extracted from Withdrawal column (NOT Deposit)?
        ‚ñ° Did I extract ALL rows with amounts, even if descriptions repeat?
        ‚ñ° Is EVERY date associated with a row that has a Withdrawal amount?
        ‚ñ° Is EVERY description associated with a row that has a Withdrawal amount?

        ‚ö†Ô∏è COMMON ERRORS TO CHECK:
        ‚ñ° Did I accidentally extract amounts from Deposit column? ‚Üí Remove them!
        ‚ñ° Did I include dates from rows with blank Withdrawal? ‚Üí Remove them!
        ‚ñ° Did I include descriptions from rows with blank Withdrawal? ‚Üí Remove them!
        ‚ñ° Did I skip any duplicate descriptions? ‚Üí Add them back!

        If lists have different counts ‚Üí ERROR, find and fix mismatched extraction!

        ### OUTPUT FORMAT:

        DOCUMENT_TYPE: BANK_STATEMENT
        STATEMENT_DATE_RANGE: [first date to last date in DD/MM/YYYY format]
        LINE_ITEM_DESCRIPTIONS: [description1 | description2 | description3]
        TRANSACTION_DATES: [DD/MM/YYYY | DD/MM/YYYY | DD/MM/YYYY]
        TRANSACTION_AMOUNTS_PAID: [$amount1 | $amount2 | $amount3]

    # Minimal variant - ultra-simple direct approach
    minimal:
      invoice: |
        Extract invoice data. Start immediately with field values.

        DOCUMENT_TYPE: INVOICE
        BUSINESS_ABN: [11-digit ABN or NOT_FOUND]
        SUPPLIER_NAME: [Business name or NOT_FOUND]
        BUSINESS_ADDRESS: [Business address or NOT_FOUND]
        PAYER_NAME: [Customer name or NOT_FOUND]
        PAYER_ADDRESS: [Customer address or NOT_FOUND]
        INVOICE_DATE: [DD/MM/YYYY or NOT_FOUND]
        LINE_ITEM_DESCRIPTIONS: [Item 1 | Item 2 | etc. or NOT_FOUND]
        LINE_ITEM_QUANTITIES: [Qty 1 | Qty 2 | etc. or NOT_FOUND]
        LINE_ITEM_PRICES: [$price 1 | $price 2 | etc. or NOT_FOUND]
        LINE_ITEM_TOTAL_PRICES: [$total 1 | $total 2 | etc. or NOT_FOUND]
        IS_GST_INCLUDED: [true or false or NOT_FOUND]
        GST_AMOUNT: [$amount or NOT_FOUND]
        TOTAL_AMOUNT: [$amount or NOT_FOUND]

      receipt: |
        Extract receipt data. Start immediately with field values.

        DOCUMENT_TYPE: RECEIPT
        BUSINESS_ABN: [11-digit ABN or NOT_FOUND]
        SUPPLIER_NAME: [Store name or NOT_FOUND]
        BUSINESS_ADDRESS: [Store address or NOT_FOUND]
        PAYER_NAME: [Customer name or NOT_FOUND]
        PAYER_ADDRESS: [Customer address or NOT_FOUND]
        INVOICE_DATE: [DD/MM/YYYY or NOT_FOUND]
        LINE_ITEM_DESCRIPTIONS: [Item 1 | Item 2 | etc. or NOT_FOUND]
        LINE_ITEM_QUANTITIES: [Qty 1 | Qty 2 | etc. or NOT_FOUND]
        LINE_ITEM_PRICES: [$price 1 | $price 2 | etc. or NOT_FOUND]
        LINE_ITEM_TOTAL_PRICES: [$total 1 | $total 2 | etc. or NOT_FOUND]
        IS_GST_INCLUDED: [true or false or NOT_FOUND]
        GST_AMOUNT: [$amount or NOT_FOUND]
        TOTAL_AMOUNT: [$amount or NOT_FOUND]

      bank_statement: |
        Look at the bank statement transaction table.

        ‚ö†Ô∏è ONE CRITICAL RULE: Only extract rows where the Withdrawal column has a dollar amount.

        The table has columns like:
        Date | Description | Withdrawal | Deposit | Balance

        EXTRACTION RULE:
        ‚Ä¢ Withdrawal column has amount (e.g., $100.00)? ‚Üí EXTRACT this row
        ‚Ä¢ Withdrawal column is blank/empty? ‚Üí SKIP this row completely

        DO NOT EXTRACT:
        ‚úó Rows where Withdrawal is blank (even if Deposit has value)
        ‚úó INCOME DEPOSIT (Withdrawal blank)
        ‚úó INTEREST CREDIT (Withdrawal blank)
        ‚úó PAYROLL CREDIT (Withdrawal blank)
        ‚úó Any row with blank Withdrawal column

        EXTRACT ONLY:
        ‚úì Rows with dollar amount in Withdrawal column
        ‚úì PURCHASE (has Withdrawal amount)
        ‚úì WITHDRAWAL (has Withdrawal amount)
        ‚úì PAYMENT (has Withdrawal amount)

        VISUAL CHECK:
        Date       | Description          | Withdrawal | Deposit | Balance
        DD/MM/YYYY | STORE PURCHASE      | $XX.XX     |         | $YYYY.YY  ‚Üê EXTRACT (has Withdrawal)
        DD/MM/YYYY | INCOME CREDIT       |            | $AAAA   | $BBBB.BB  ‚Üê SKIP (Withdrawal blank)
        DD/MM/YYYY | ATM WITHDRAWAL      | $ZZZ.ZZ    |         | $CCCC.CC  ‚Üê EXTRACT (has Withdrawal)

        For each row with Withdrawal amount, extract:
        - Transaction date (DD/MM/YYYY)
        - Description text
        - Withdrawal amount (with $)

        OUTPUT FORMAT:
        DOCUMENT_TYPE: BANK_STATEMENT
        STATEMENT_DATE_RANGE: [earliest date to latest date]
        LINE_ITEM_DESCRIPTIONS: [desc1 | desc2 | desc3]
        TRANSACTION_DATES: [DD/MM/YYYY | DD/MM/YYYY | DD/MM/YYYY]
        TRANSACTION_AMOUNTS_PAID: [$amt1 | $amt2 | $amt3]

  # InternVL3 models - concise direct approach
  internvl3:
    invoice: |
      Extract ALL data from this invoice image. Respond in exact format below with actual values or NOT_FOUND.

      DOCUMENT_TYPE: INVOICE
      BUSINESS_ABN: NOT_FOUND
      SUPPLIER_NAME: NOT_FOUND
      BUSINESS_ADDRESS: NOT_FOUND
      PAYER_NAME: NOT_FOUND
      PAYER_ADDRESS: NOT_FOUND
      INVOICE_DATE: NOT_FOUND
      LINE_ITEM_DESCRIPTIONS: NOT_FOUND
      LINE_ITEM_QUANTITIES: NOT_FOUND
      LINE_ITEM_PRICES: NOT_FOUND
      LINE_ITEM_TOTAL_PRICES: NOT_FOUND
      IS_GST_INCLUDED: NOT_FOUND
      GST_AMOUNT: NOT_FOUND
      TOTAL_AMOUNT: NOT_FOUND

      Instructions:
      - Find ABN: 11 digits like "12 345 678 901"
      - Find supplier: Business name at top
      - Find customer: "Bill To" section
      - Find date: Use DD/MM/YYYY format
      - Find line items: List with " | " separator
      - Find amounts: Include $ symbol
      - Replace NOT_FOUND with actual values

    receipt: |
      Extract ALL data from this receipt image. Respond in exact format below with actual values or NOT_FOUND.

      DOCUMENT_TYPE: RECEIPT
      BUSINESS_ABN: NOT_FOUND
      SUPPLIER_NAME: NOT_FOUND
      BUSINESS_ADDRESS: NOT_FOUND
      PAYER_NAME: NOT_FOUND
      PAYER_ADDRESS: NOT_FOUND
      INVOICE_DATE: NOT_FOUND
      LINE_ITEM_DESCRIPTIONS: NOT_FOUND
      LINE_ITEM_QUANTITIES: NOT_FOUND
      LINE_ITEM_PRICES: NOT_FOUND
      LINE_ITEM_TOTAL_PRICES: NOT_FOUND
      IS_GST_INCLUDED: NOT_FOUND
      GST_AMOUNT: NOT_FOUND
      TOTAL_AMOUNT: NOT_FOUND

      Instructions:
      - Find ABN: 11 digits like "12 345 678 901"
      - Find store: Business name at top
      - Find transaction date: Use DD/MM/YYYY format
      - Find purchased items: List with " | " separator
      - Find amounts: Include $ symbol
      - Replace NOT_FOUND with actual values

    bank_statement: |
      Extract structured data from this bank statement for taxpayer expense claims.

      ‚ö†Ô∏è CRITICAL: Extract ONLY DEBIT/WITHDRAWAL transactions (money OUT).
      IGNORE ALL deposits and credits (money IN).

      Column headers may be "Withdrawal/Deposit" OR "Debit/Credit" - they mean the same thing!

      WITHDRAWAL/DEBIT (Extract - money OUT):
      - Has amount in "Withdrawal" or "Debit" column
      - OR has negative sign: "-$100.00" or "-100.00"
      - Balance DECREASES
      - Examples: withdrawals, purchases, payments, fees
      - Keywords: withdrawal, purchase, payment, debit, fee

      DEPOSIT/CREDIT (Skip - money IN):
      - Has amount in "Deposit" or "Credit" column
      - Withdrawal/Debit column is BLANK
      - OR has positive sign: "+$500.00" or no sign
      - Balance INCREASES
      - Examples: income, deposits, interest
      - Keywords: salary, deposit, credit, interest, transfer in, refund

      Identify withdrawals by:
      1. For 5-column: Withdrawal/Debit column has AMOUNT (not blank, not "-")
      2. For 3-4 column: Amount has "-" prefix/negative number
      3. Balance DECREASED from previous row
      4. Description keywords (purchase, withdrawal, payment, fee)

      ‚ö†Ô∏è CRITICAL RULES:
      - If Withdrawal/Debit column is BLANK but Deposit/Credit column has value ‚Üí SKIP!
      - Do NOT extract income/salary transactions - Withdrawal column is blank
      - Do NOT extract interest/refund transactions - Withdrawal column is blank
      - ONLY extract rows where Withdrawal/Debit column has a dollar amount

      Output format (5 FIELDS):

      DOCUMENT_TYPE: BANK_STATEMENT
      STATEMENT_DATE_RANGE: NOT_FOUND
      LINE_ITEM_DESCRIPTIONS: NOT_FOUND
      TRANSACTION_DATES: NOT_FOUND
      TRANSACTION_AMOUNTS_PAID: NOT_FOUND

      Instructions:
      - Statement period: Earliest to latest transaction date (DD/MM/YYYY to DD/MM/YYYY)
      - Transaction descriptions: DEBIT descriptions only, " | " separator
      - Transaction dates: DEBIT dates only, DD/MM/YYYY, " | " separator
      - Amounts paid: Debit amounts with $, " | " separator (money OUT only)
      - VERIFY: No salary/deposit/credit transactions in output
      - Use NOT_FOUND for missing fields

# Use model-specific instructions when appropriate (set by model_name parameter)
use_model_specific_instructions: true

# ============================================================================
# BANK STATEMENT STRUCTURE-SPECIFIC PROMPTS (Phase 2)
# ============================================================================

# Structure-specific extraction prompts based on classified layout
bank_statement_structure_prompts:
  TABLE_3COL_SIMPLE:
    extraction_focus: |
      This bank statement has 3 columns: Date | Description | Amount
      - Extract from single amount column (includes both debits and credits)
      - Identify debits by negative signs or withdrawal indicators

  TABLE_4COL_STANDARD:
    extraction_focus: |
      This bank statement has 4 columns: Date | Description | Debit | Credit
      - Extract ONLY from Debit column (column 3)
      - Skip Credit column entries
      - Debit column is BEFORE Credit column

  TABLE_4COL_REVERSED:
    extraction_focus: |
      This bank statement has REVERSED columns: Date | Description | Credit | Debit
      - CRITICAL: Credit column comes BEFORE Debit column
      - Extract from Debit column (column 4, rightmost before balance)

  TABLE_5COL_STANDARD:
    extraction_focus: |
      This bank statement has 5 columns: Date | Transaction | Debit | Credit | Balance
      - Extract from Debit column (column 3)
      - Use Balance column for validation
      - Running balance helps identify transaction order

  TABLE_5COL_DETAILED:
    extraction_focus: |
      This bank statement has 5 columns with multi-row transactions
      - "Particulars" column may have multiple detail lines
      - Combine multi-line descriptions for same transaction
      - Extract main transaction row debits

  MOBILE_APP_DARK:
    extraction_focus: |
      This is a mobile banking app with dark theme
      - No column headers
      - Transactions grouped under day names (Wed, Thu, etc.)
      - Extract from card-based layout

  MOBILE_APP_LIGHT_INLINE:
    extraction_focus: |
      This is a mobile banking app with inline balance
      - Look for "bal $XXX.XX" text pattern
      - Category labels below descriptions
      - Merchant logos may be present

# Hot reload support
version: "2.0.0"
last_updated: "2025-11-19"
